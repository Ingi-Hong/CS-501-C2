#include "aes_gcm.h"

int main(){

    BYTE textIV[] = {0x87, 0xb8, 0xa9, 0xa6, 0xc2, 0x39, 0x42, 0x5f, 0xc2, 0xda, 0x8c, 0xc1};
    BYTE key[] = {0x41, 0x13, 0xcd, 0xa3, 0xa0, 0xe0, 0xab, 0x5e, 0x19, 0xf1, 0xc0, 0x1c, 0x6d, 0x4e, 0x77, 0xc5, 0xe5, 0x20, 0xd2, 0x44, 0xe, 0x52, 0xae, 0x87, 0xaa, 0xa, 0x96, 0x67, 0x28, 0x82, 0xea, 0x8};
    BYTE message[] = "Test message";
    BYTE ciphertext[] ={0x3f, 0xc4, 0x4d, 0xa3, 0x55, 0xda, 0xf, 0x32, 0xb6, 0xd2, 0x89, 0x7b, 0x36, 0x90, 0x93, 0xbd, 0xf4, 0x8e, 0xeb, 0xd, 0x35, 0x24, 0xf0, 0xdc, 0x60, 0xaf, 0x39, 0xc5};
    auto box = new AESGCM(key);
    box->Encrypt( (BYTE*) textIV, sizeof(textIV), (BYTE*) message, sizeof(message));
    box->Decrypt(textIV, sizeof(textIV), box->ciphertext, sizeof(message), box->tag, box->authTagLengths.dwMinLength );
    
    for(size_t i=0; i< box->ptBufferSize; i++){
        printf("%c", (char) box->plaintext[i]);
    }
    printf("\n");
    delete box;
    printf("Goodbye!\n");
    return 0;
}